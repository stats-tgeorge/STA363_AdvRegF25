{
  "hash": "2c277b28937cb84b984edf1e7a8dc6f2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Beyond Least Squares: Using Likelihoods\"\nsubtitle: \"BMLR Chapter 2\"\nformat: \n  revealjs:\n    output-file: \"02_likelihoods_ch2.html\"\n    slide-number: true\n  html:\n    output-file: \"02_likelihoods_ch2_o.html\"\nlogo: \"../img/favicon.png\"\n---\n\n::: {.cell}\n\n:::\n\n\n## Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(GGally)\nlibrary(knitr)\nlibrary(patchwork)\nlibrary(viridis)\nlibrary(ggfortify)\n```\n:::\n\n\n## Learning goals \n\n- Describe the concept of a likelihood\n\n- Construct the likelihood for a simple model\n\n- Define the Maximum Likelihood Estimate (MLE) and use it to answer an analysis question\n\n- Identify three ways to calculate or approximate the MLE and apply these methods to find the MLE for a simple model\n\n- Use likelihoods to compare models (next week)\n\n# Likelihood\n\n## What is the likelihood? {.smaller}\n\nA **likelihood** is a function that tells us how likely we are to observe our data for a given parameter value (or values). \n\n- Unlike Ordinary Least Squares (OLS), they do not require the responses be independent, identically distributed, and normal (iidN)\n\n- They are **not** the same as probability functions\n\n  - **Probability function:** Fixed parameter value(s) + input possible outcomes $\\Rightarrow$ probability of seeing the different outcomes given the parameter value(s)\n  \n\n  \n  - **Likelihood:** Fixed data + input possible parameter values $\\Rightarrow$ probability of seeing the fixed data for each parameter value\n\n\n\n## Fouls in college basketball games {.smaller}\n\nThe data set [`04-refs.csv`](data/04-refs.csv) includes 30 randomly selected NCAA men's basketball games played in the 2009 - 2010 season.\n\nWe will focus on the variables `foul1`, `foul2`, and `foul3`, which indicate which team had a foul called them for the 1st, 2nd, and 3rd fouls, respectively. \n\n  - `H`: Foul was called on the home team \n  - `V`: Foul was called on the visiting team\n  \n. . .\n\nWe are focusing on the first three fouls for this analysis, but this could easily be extended to include all fouls in a game. \n\n::: footer\n[The dataset was derived from `basektball0910.csv` used in [BMLR Section 11.2](https://bookdown.org/roback/bookdown-BeyondMLR/ch-GLMM.html#cs:refs)\n:::\n\n\n## Fouls in college basketball games\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrefs <- read_csv(\"data/04-refs.csv\")\nrefs %>% slice(1:5) %>% kable()\n```\n\n::: {.cell-output-display}\n\n\n| game|     date|visitor |hometeam |foul1 |foul2 |foul3 |\n|----:|--------:|:-------|:--------|:-----|:-----|:-----|\n|  166| 20100126|CLEM    |BC       |V     |V     |V     |\n|  224| 20100224|DEPAUL  |CIN      |H     |H     |V     |\n|  317| 20100109|MARQET  |NOVA     |H     |H     |H     |\n|  214| 20100228|MARQET  |SETON    |V     |V     |H     |\n|  278| 20100128|SETON   |SFL      |H     |V     |V     |\n\n\n:::\n:::\n\n\nWe will treat the games as independent in this analysis.\n\n\n\n## Different likelihood models {.smaller}\n\n**Model 1 (Unconditional Model)**: What is the probability the referees call a foul on the home team, assuming foul calls within a game are independent? \n\n<br> \n\n**Model 2 (Conditional Model)**: \n\n  - Is there a tendency for the referees to call more fouls on the visiting team or home team? \n  \n  - Is there a tendency for referees to call a foul on the team that already has more fouls? \n \n. . .\n\nUltimately we want to decide which model is better.\n\n\n\n## Exploratory data analysis {.smaller}\n\n:::: {.columns}\n::: {.column}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrefs %>%\ncount(foul1, foul2, foul3) %>% kable()\n```\n\n::: {.cell-output-display}\n\n\n|foul1 |foul2 |foul3 |  n|\n|:-----|:-----|:-----|--:|\n|H     |H     |H     |  3|\n|H     |H     |V     |  2|\n|H     |V     |H     |  3|\n|H     |V     |V     |  7|\n|V     |H     |H     |  7|\n|V     |H     |V     |  1|\n|V     |V     |H     |  5|\n|V     |V     |V     |  2|\n\n\n:::\n:::\n\n\n:::\n\n:::{.column}\n\nThere are \n\n- 46 total fouls on the home team\n\n- 44 total fouls on the visiting team \n\n:::\n::::\n\n\n## Model 1: Unconditional model\n\n*What is the probability the referees call a foul on the home team, assuming foul calls within a game are independent?*\n\n\n## Likelihood {.smaller}\n\nLet $p_H$ be the probability the referees call a foul on the home team. \n\n**The likelihood for a single observation** \n\n$$Lik(p_H) = p_H^{y_i}(1 - p_H)^{n_i - y_i}$$\n\nWhere $y_i$ is the number of fouls called on the home team. \n\n(In this example, we know $n_i = 3$ for all observations.)\n\n. . .\n\n**Example**\n\nFor a single game where the first three fouls are $H, H, V$, then\n\n$$Lik(p_H) = p_H^{2}(1 - p_H)^{3 - 2} = p_H^{2}(1 - p_H)$$\n\n\n\n## Model 1: Likelihood contribution {.smaller}\n\n\n| Foul1 | Foul2 | Foul3 | n | Likelihood Contribution |\n|-------|-------|-------|---|:-----------------------:|\n| H     | H     | H     | 3 |       $p_H^3$           |\n| H     | H     | V     | 2 |        $p_H^2(1 - p_H)$ |\n| H     | V     | H     | 3 |        $p_H^2(1 - p_H)$ |\n| H     | V     | V     | 7 |       A                 |\n| V     | H     | H     | 7 |        B                |\n| V     | H     | V     | 1 |       $p_H(1 - p_H)^2$  |\n| V     | V     | H     | 5 |         $p_H(1 - p_H)^2$|\n| V     | V     | V     | 2 |         $(1 - p_H)^3$   |\n\n. . .\n\nFill in **A** and **B**.\n\n\n## Model 1: Likelihood function\n\nBecause the observations (the games) are independent, the **likelihood** is\n\n$$Lik(p_H) = \\prod_{i=1}^{n}p_H^{y_i}(1 - p_H)^{3 - y_i}$$\n\n\nWe will use this function to find the **maximum likelihood estimate (MLE)**. The MLE is the value between 0 and 1 where we are most likely to see the observed data.\n\n\n\n## Visualizing the likelihood\n\n:::{.panel-tabset}\n\n### Plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_likelihoods_ch2_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n### Code \n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- seq(0,1, length.out = 100) #sequence of 100 values between 0 and 100\nlik <- p^46 *(1 -p)^44\n\nx <- tibble(p = p, lik = lik)\nggplot(data = x, aes(x = p, y = lik)) + \n  geom_point() + \n  geom_line() +\n  labs(y = \"Likelihood\",\n       title = \"Likelihood of p_H\")\n```\n:::\n\n\n:::\n\n\n## Q: What is your best guess for the MLE, $\\hat{p}_H$?\n\nA. 0.489\n\nB. 0.500\n\nC. 0.511\n\nD. 0.556\n\n## Finding the maximum likelihood estimate \n\nThere are three primary ways to find the MLE \n\n. . .\n\n✅ Approximate using a graph\n\n. . .\n\n✅ Numerical approximation \n\n. . .\n\n✅ Using calculus\n\n\n\n## Approximate MLE from a graph \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_likelihoods_ch2_files/figure-revealjs/unnamed-chunk-7-1.png){width=80%}\n:::\n:::\n\n\n\n\n## Find the MLE using numerical approximation\n\nSpecify a finite set of possible values the for $p_H$ and calculate the likelihood for each value\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# write an R function for the likelihood\nref_lik <- function(ph) {\n  ph^46 *(1 - ph)^44\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# use the optimize function to find the MLE\noptimize(ref_lik, interval = c(0,1), maximum = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$maximum\n[1] 0.5111132\n\n$objective\n[1] 8.25947e-28\n```\n\n\n:::\n:::\n\n\n\n\n## Find MLE using calculus {.smaller}\n\n- Find the MLE by taking the first derivative of the likelihood function. \n\n- This can be tricky because of the Product Rule, so we can maximize the **log(Likelihood)** instead. The same value maximizes the likelihood and log(Likelihood)\n\n\n. . .\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_likelihoods_ch2_files/figure-revealjs/unnamed-chunk-10-1.png){width=60%}\n:::\n:::\n\n\n. . .\n\nSince calculus is not a pre-req, we will forgo this quest. \n\n## Model 2: Conditional model \n\n- Is there a tendency for the referees to call more fouls on the visiting team or home team? \n\n- Is there a tendency for referees to call a foul on the team that already has more fouls?\n\n\n\n## Model 2: Likelihood contributions {.smaller}\n\n- Now let's assume fouls are **not** independent within each game. We will specify this dependence using conditional probabilities. \n  - **Conditional probability**: $P(A|B) =$ Probability of $A$ given $B$ has occurred\n\n\n. . .\n\nDefine new parameters:\n\n- $p_{H|N}$: Probability referees call foul on home team given there are equal numbers of fouls on the home and visiting teams \n\n\n\n- $p_{H|H Bias}$: Probability referees call foul on home team given there are more prior fouls on the home team\n\n\n\n- $p_{H|V Bias}$: Probability referees call foul on home team given there are more prior fouls on the visiting team \n\n\n\n## Model 2: Likelihood contributions {.smaller}\n\n| Foul1 | Foul2 | Foul3 | n | Likelihood Contribution                                                                                                                         |\n|-------|-------|-------|---|:-----------------------------------------------------------------------------------------------------------------------------------------------:|\n| H     | H     | H     | 3 |$(p_{H\\vert N})(p_{H\\vert H Bias})(p_{H\\vert H Bias}) = (p_{H\\vert N})(p_{H\\vert H Bias})^2$                                               |\n| H     | H     | V     | 2 |$(p_{H\\vert N})(p_{H\\vert H Bias})(1 - p_{H\\vert H Bias})$                                                                                 |\n| H     | V     | H     | 3 |$(p_{H\\vert N})(1 - p_{H\\vert H Bias})(p_{H\\vert N}) = (p_{H\\vert N})^2(1 - p_{H\\vert H Bias})$                                            |\n| H     | V     | V     | 7 |A                                                                                                                                          |\n| V     | H     | H     | 7 |B                                                                                                                                          |\n| V     | H     | V     | 1 |$(1 - p_{H\\vert N})(p_{H\\vert V Bias})(1 - p_{H\\vert N}) = (1 - p_{H\\vert N})^2(p_{H\\vert V Bias})$                                        |\n| V     | V     | H     | 5 |$(1 - p_{H\\vert N})(1-p_{H\\vert V Bias})(p_{H\\vert V Bias})$                                                                               |\n| V     | V     | V     | 2 |$\\begin{aligned}&(1 - p_{H\\vert N})(1-p_{H\\vert V Bias})(1-p_{H\\vert V Bias})\\\\ &=(1 - p_{H\\vert N})(1-p_{H\\vert V Bias})^2\\end{aligned}$|\n\n\n\nFill in **A** and **B**\n\n\n\n## Likelihood function \n\n$$\\begin{aligned}Lik(p_{H| N}, p_{H|H Bias}, p_{H |V Bias}) &= [(p_{H| N})^{25}(1 - p_{H|N})^{23}(p_{H| H Bias})^8 \\\\ &(1 - p_{H| H Bias})^{12}(p_{H| V Bias})^{13}(1-p_{H|V Bias})^9]\\end{aligned}$$      \n\n**(Note: The exponents sum to 90, the total number of fouls in the data)**\n\n. . .\n\n\n\n$$\\begin{aligned}\\log (Lik(p_{H| N}, p_{H|H Bias}, p_{H |V Bias})) &= 25 \\log(p_{H| N}) + 23 \\log(1 - p_{H|N}) \\\\ & + 8 \\log(p_{H| H Bias}) + 12 \\log(1 - p_{H| H Bias})\\\\ &+ 13 \\log(p_{H| V Bias}) + 9 \\log(1-p_{H|V Bias})\\end{aligned}$$   \n\n## Q: If fouls within a game are independent, how would you expect $\\hat{p}_H$, $\\hat{p}_{H\\vert H Bias}$ and $\\hat{p}_{H\\vert V Bias}$ to compare? \n\na. $\\hat{p}_H$ is greater than $\\hat{p}_{H\\vert H Bias}$ and $\\hat{p}_{H \\vert V Bias}$\n\nb. $\\hat{p}_{H\\vert H Bias}$ is greater than $\\hat{p}_H$ and $\\hat{p}_{H \\vert V Bias}$\n\nc. $\\hat{p}_{H\\vert V Bias}$ is greater than $\\hat{p}_H$ and $\\hat{p}_{H \\vert V Bias}$\n\nd. They are all approximately equal.\n\n\n\n\n## Q: If there is a tendency for referees to call a foul on the team that already has more fouls, how would you expect $\\hat{p}_H$ and  $\\hat{p}_{H\\vert H Bias}$ to compare? \n\na. $\\hat{p}_H$ is greater than  $\\hat{p}_{H\\vert H Bias}$ \n\nb. $\\hat{p}_{H\\vert H Bias}$ is greater than $\\hat{p}_H$\n\nc. They are approximately equal.\n\n\n\n\n## Likelihoods {.smaller}\n\n**Model 1 (Unconditional Model)**\n\n- $p_H$: probability of a foul being called on the home team\n\n. . .\n\n**Model 2 (Conditional Model)**\n\n- $p_{H|N}$: Probability referees call foul on home team given there are equal numbers of fouls on the home and visiting teams\n- $p_{H|H Bias}$: Probability referees call foul on home team given there are more prior fouls on the home team\n- $p_{H|V Bias}$: Probability referees call foul on home team given there are more prior fouls on the visiting team\n    \n\n\n\n## Likelihoods\n\n**Model 1 (Unconditional Model)**\n\n$$Lik(p_H) = p_H^{46}(1 - p_H)^{44}$$\n\n. . .\n\n\n**Model 2 (Conditional Model)**\n\n$$\\begin{aligned}Lik(p_{H| N}, p_{H|H Bias}, p_{H |V Bias}) &= [(p_{H| N})^{25}(1 - p_{H|N})^{23}(p_{H| H Bias})^8 \\\\ &(1 - p_{H| H Bias})^{12}(p_{H| V Bias})^{13}(1-p_{H|V Bias})^9]\\end{aligned}$$     \n\n\n\n\n## Maximum likelihood estimates {.smaller}\n\nThe **maximum likelihood estimate (MLE)** is the value between 0 and 1 where we are most likely to see the observed data.\n\n. . .\n\n::::{.columns}\n\n:::{.column}\n\n**Model 1 (Unconditional Model)**\n\n- $\\hat{p}_H = 46/90 = 0.511$\n\n\n**Model 2 (Conditional Model)**\n\n- $\\hat{p}_{H|N} = 25 / 48 = 0.521$\n- $\\hat{p}_{H|H Bias} = 8 /20 = 0.4$\n- $\\hat{p}_{H|V Bias} = 13/ 22 = 0.591$\n\n:::\n\n:::{.column}\n\n- What is the probability the referees call a foul on the home team, assuming foul calls within a game are independent? \n- Is there a tendency for the referees to call more fouls on the visiting team or home team? \n- Is there a tendency for referees to call a foul on the team that already has more fouls? \n\n:::\n::::\n\n\n## Finding the MLEs for model 2 {.smaller}\n\n\nThe likelihood is \n\n\n$$\\begin{aligned}Lik(p_{H| N}, p_{H|H Bias}, p_{H |V Bias}) &= [(p_{H| N})^{25}(1 - p_{H|N})^{23}(p_{H| H Bias})^8 \\\\ &(1 - p_{H| H Bias})^{12}(p_{H| V Bias})^{13}(1-p_{H|V Bias})^9]\\end{aligned}$$  \n\n. . .\n\nThe log-likelihood is \n\n$$\\begin{aligned}\\log (Lik(p_{H| N}, p_{H|H Bias}, p_{H |V Bias})) &= 25 \\log(p_{H| N}) + 23 \\log(1 - p_{H|N}) \\\\ & + 8 \\log(p_{H| H Bias}) + 12 \\log(1 - p_{H| H Bias})\\\\ &+ 13 \\log(p_{H| V Bias}) + 9 \\log(1-p_{H|V Bias})\\end{aligned}$$   \n\n. . .\n\nWe would like to find the MLEs for $p_{H| N}, p_{H|H Bias}, \\text{ and }p_{H |V Bias}$.\n\n\n## Finding MLEs using graphs {.smaller}\n\n- We need to find the MLEs for three parameters, therefore we would need to visualize a 4-dimensional object to find the MLEs from a graph. Given the difficulty of this task and the lack of precision in the estimates from this approach, we should rely on other approaches to find the MLEs in this instance.\n\n. . .\n\n- We also can't use calculus... that leaves only 1 approach.... optimization via  grid search or *optim* in R\n\n## Finding the MLEs using R (1/3) {.smaller}\n\nWe can write a function and do a grid search to find the values that maximize the log-likelihood.\n\n. . .\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmaxloglik<- function(nvals){\n  #nvals specifies the number of values\n  phn <- seq(0, 1, length = nvals)\n  phh <- seq(0, 1, length = nvals)\n  phv <- seq(0, 1, length = nvals)\n  \n  loglik <- expand.grid(phn, phh, phv) \n  colnames(loglik) <- c(\"phn\", \"phh\", \"phv\")\n  \n  loglik <- loglik %>%\n    mutate(loglik  = log(phn^25 * (1 - phn)^23 * phh^8 * (1 - phh)^12 * \n                           phv^13 * (1 - phv)^9))\n  \n  loglik %>%\n    arrange(desc(loglik)) %>%\n    slice(1)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmaxloglik(100)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        phn       phh       phv    loglik\n1 0.5252525 0.4040404 0.5858586 -61.57691\n```\n\n\n:::\n:::\n\n\n## Finding the MLEs using R (2/3) {.smaller}\n\n- Depending on the number of parameters, it may be hard to conduct a granular enough search to find the exact values of the MLEs. \n- Therefore, one could use the function above to conduct a crude search to find starting values for R's `optim` function. \n- The function `optim` differs from `optimize` in that it can optimize over multiple parameter values (The `optimize` function can only optimize over a single parameter value).\n\n. . .\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Function to calculate log-likelihood that will be used in the optim function\nloglik <- function(params){\n  phn <- params[1]\n  phh <- params[2]\n  phv <- params[3]\n\n  log(phn^25 * (1 - phn)^23 * phh^8 * (1 - phh)^12 * \n                           phv^13 * (1 - phv)^9)\n}\n```\n:::\n\n\n## Finding the MLEs using R (3/3) {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use manual search to get starting values \nstart_vals <- maxloglik(50) %>% select(-loglik)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Use optim function in R to find the values to maximize the log-likelihood\n#set fnscale = -1 to maximize (the default is minimize)\noptim(par = start_vals, fn = loglik, control=list(fnscale=-1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$par\n      phn       phh       phv \n0.5208272 0.4000361 0.5909793 \n\n$value\n[1] -61.57319\n\n$counts\nfunction gradient \n      66       NA \n\n$convergence\n[1] 0\n\n$message\nNULL\n```\n\n\n:::\n:::\n\n\n# Model Comparisons\n\n## Model comparisons \n\n- Nested models \n\n- Non-nested models\n\n## Nested Models (1/2) {.smaller}\n\n**Nested models**: Models such that the parameters of the reduced model are a subset of the parameters for a larger model \n\nExample: \n\n$$\\begin{aligned}&\\text{Model A: }y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\epsilon\\\\\n&\\text{Model B: }y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_3 + \\beta_4 x_4 + \\epsilon\\end{aligned}$$\n\n. . .\n\nModel A is nested in Model B. We could use likelihoods to test whether it is useful to add $x_3$ and $x_4$ to the model. \n\n. . .\n\n$$\\begin{aligned}&H_0: \\beta_3 = \\beta_4 = 0 \\\\ \n&H_a: \\text{ at least one }\\beta_j \\text{ is not equal to 0}\\end{aligned}$$\n\n\n\n## Nested models (2/2) {.smaller}\n\n**Another way to think about nested models**: Parameters in larger model can be equated to get the simpler model or if some parameters can be set to constants \n\nExample: \n\n$$\\begin{aligned}&\\text{Model 1: }p_H \\\\\n&\\text{Model 2: }p_{H| N}, p_{H| H Bias}, p_{H| V Bias}\\end{aligned}$$\n\n. . .\n\nModel 1 is nested in Model 2. The parameters $p_{H| N}$, $p_{H|H Bias}$, and $p_{H |V Bias}$ can be set equal to $p_H$ to get Model 1. \n\n. . .\n\n$$\\begin{aligned}&H_0: p_{H| N} = p_{H| H Bias} = p_{H| V Bias} = p_H \\\\\n&H_a: \\text{At least one of }p_{H| N}, p_{H| H Bias}, p_{H| V Bias} \\text{ differs from the others}\\end{aligned}$$\n\n\n\n## Steps to compare models {.smaller} \n\n1️⃣  Find the MLEs for each model. \n\n2️⃣  Plug the MLEs into the log-likelihood function for each model to get the maximum value of the log-likelihood for each model. \n\n3️⃣  Find the difference in the maximum log-likelihoods\n\n4️⃣  Use the Likelihood Ratio Test to determine if the difference is statistically significant \n\n\n\n## Steps 1 - 2 {.smaller}\n\nFind the MLEs for each model and plug them into the log-likelihood functions. \n\n::::{.columns}\n\n:::{.column}\n\n**Model 1:**\n\n- $\\hat{p}_H = 46/90 = 0.511$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloglik1 <- function(ph){\n log(ph^46 * (1 - ph)^44)\n}\nloglik1(46/90)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -62.36102\n```\n\n\n:::\n:::\n\n\n:::\n\n. . .\n\n:::{.column}\n**Model 2**\n\n- $\\hat{p}_{H|N} = 25 / 48 = 0.521$\n- $\\hat{p}_{H|H Bias} = 8 /20 = 0.4$\n- $\\hat{p}_{H|V Bias} = 13/ 22 = 0.591$\n\n. . .\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloglik2 <- function(phn, phh, phv) {\n  log(phn^25 * (1 - phn)^23 * phh^8 * \n        (1 - phh)^12 * phv^13 * (1 - phv)^9)\n}\nloglik2(25/48, 8/20, 13/22)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -61.57319\n```\n\n\n:::\n:::\n\n\n:::\n::::\n\n\n## Step 3\n\nFind the difference in the log-likelihoods\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(diff <- loglik2(25/48, 8/20, 13/22) - loglik1(46/90))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7878318\n```\n\n\n:::\n:::\n\n\n\n<br>\n\n\n. . .\n\n\n**Is the difference in the maximum log-likelihoods statistically significant?** \n\n\n\n## Likelihood Ratio Test {.smaller}\n\n**Test statistic**\n\n$$\\begin{aligned} LRT &= 2[\\max\\{\\log(Lik(\\text{larger model}))\\} - \\max\\{\\log(Lik(\\text{reduced model}))\\}]\\\\[10pt]\n&= 2\\log\\Bigg(\\frac{\\max\\{(Lik(\\text{larger model})\\}}{\\max\\{(Lik(\\text{reduced model})\\}}\\Bigg)\\end{aligned}$$\n\n<br> \n\n. . .\n\nLRT follows a $\\chi^2$ distribution where the degrees of freedom equal the difference in the number of parameters between the two models\n\n\n\n## Step 4 {.smaller}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(LRT <- 2 * (loglik2(25/48, 8/20, 13/22) - loglik1(46/90)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.575664\n```\n\n\n:::\n:::\n\n\n. . .\n\nThe test statistic follows a $\\chi^2$ distribution with 2 degrees of freedom. Therefore, the p-value is $P(\\chi^2 > LRT)$. \n\n\n::: {.cell}\n\n```{.r .cell-code}\npchisq(LRT, 2, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.4548299\n```\n\n\n:::\n:::\n\n\n. . .\n\nThe p-value is very large, so we fail to reject $H_0$. We do not have convincing evidence that the conditional model is an improvement over the unconditional model. Therefore, we can stick with the unconditional model. \n\n## Comparing non-nested models{.smaller}\n\n::::{.columns}\n:::{.column}\n\n**AIC** = -2(max log-likelihood) + 2p\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(Model1_AIC <- 2 * loglik1(46/90) + 2 * 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -122.722\n```\n\n\n:::\n\n```{.r .cell-code}\n(Model2_AIC <-2 * loglik2(25/48, 8/20, 13/22) + 2 * 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -117.1464\n```\n\n\n:::\n:::\n\n\n:::\n\n. . .\n\n:::{.column}\n**BIC** = -2(max log-likelihood) + plog(n)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(Model1_BIC <- 2 * loglik1(46/90) + 1 * log(30))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -121.3208\n```\n\n\n:::\n\n```{.r .cell-code}\n(Model2_BIC <-2 * loglik2(25/48, 8/20, 13/22) + 3 * log(30))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -112.9428\n```\n\n\n:::\n:::\n\n\n**Choose Model 1, the unconditional model, based on AIC and BIC**\n\n:::\n::::\n\n\n\n## Looking ahead{.smaller}\n\n- Likelihoods help us answer the question of how likely we are to observe the data given different parameters\n\n\n- In this example, we did not consider covariates, so in practice the parameters we want to estimate will look more similar to this\n \n. . .\n\n$$p_H = \\frac{e^{\\beta_0 + \\beta_1x_1 + \\dots + \\beta_px_p}}{1 + e^{\\beta_0 + \\beta_1x_1 + \\dots + \\beta_px_p}}$$\n\n. . .\n\n- Finding the MLE becomes much more complex and numerical methods may be required.\n  - We will primarily rely on software to find the MLE, but the conceptual ideas will be the same\n  \n\n## Acknowledgements\n\nThese slides are based on content in [BMLR: Chapter 1 - Review of Multiple Linear Regression](https://bookdown.org/roback/bookdown-BeyondMLR/ch-MLRreview.html)\n\nInitial versions of the slides are by Dr. Maria Tackett, Duke University\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}